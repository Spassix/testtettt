let editingSocialId=null;async function initSocials(){await loadSocials(),setupSocialsUI()}async function loadSocials(){renderSocials(await BackendData.loadData("socials"))}function renderSocials(socials){const list=document.getElementById("socialsList");list&&(0!==socials.length?list.innerHTML=socials.map(s=>`\n    <div class="list-item">\n      <div class="list-item-info">\n        <div class="list-item-title">${AdminUtils.escapeHtml(s.name)}</div>\n        <div class="list-item-meta">${AdminUtils.escapeHtml(s.url)}</div>\n      </div>\n      <div class="list-item-actions">\n        <button class="btn-secondary" onclick="editSocial(${s.id})">Modifier</button>\n        <button class="btn-danger" onclick="deleteSocial(${s.id})">Supprimer</button>\n      </div>\n    </div>\n  `).join(""):list.innerHTML='<div style="text-align: center; padding: 2rem; color: var(--text-secondary);">Aucun réseau social</div>')}function setupSocialsUI(){const addBtn=document.getElementById("addSocialBtn");addBtn&&addBtn.addEventListener("click",()=>{openSocialModal()}),modalManager.setupModal("socialModal",saveSocial,()=>{editingSocialId=null,resetForm("socialForm"),document.getElementById("socialNameCustom").style.display="none"});const nameSelect=document.getElementById("socialName"),nameCustomInput=document.getElementById("socialNameCustom");nameSelect&&nameCustomInput&&nameSelect.addEventListener("change",()=>{"Autre"===nameSelect.value?(nameCustomInput.style.display="block",nameCustomInput.required=!0):(nameCustomInput.style.display="none",nameCustomInput.required=!1,nameCustomInput.value="")})}function openSocialModal(social=null){editingSocialId=social?.id||null,document.getElementById("socialModal");const title=document.getElementById("socialModalTitle"),nameSelect=document.getElementById("socialName"),nameCustomInput=document.getElementById("socialNameCustom"),urlInput=document.getElementById("socialUrl");social?(title.textContent="Modifier le réseau social",["Instagram","TikTok","Snapchat","Telegram","WhatsApp","Facebook","Twitter","YouTube"].includes(social.name)?(nameSelect.value=social.name,nameCustomInput.style.display="none",nameCustomInput.required=!1):(nameSelect.value="Autre",nameCustomInput.value=social.name,nameCustomInput.style.display="block",nameCustomInput.required=!0),urlInput.value=social.url||"",urlInput.setAttribute("data-editing-id",social.id)):(title.textContent="Ajouter un réseau social",nameSelect.value="",nameCustomInput.value="",nameCustomInput.style.display="none",nameCustomInput.required=!1,urlInput.value="",urlInput.removeAttribute("data-editing-id")),modalManager.open("socialModal")}async function saveSocial(){const nameSelect=document.getElementById("socialName"),nameCustomInput=document.getElementById("socialNameCustom"),urlInput=document.getElementById("socialUrl"),name="Autre"===nameSelect.value?nameCustomInput.value.trim():nameSelect.value,url=urlInput.value.trim();if(!name)return AdminUtils.showToast("Le nom est requis","error"),("Autre"===nameSelect.value?nameCustomInput:nameSelect).focus(),!1;if(!url)return AdminUtils.showToast("Le lien est requis","error"),urlInput.focus(),!1;const socials=await BackendData.loadData("socials"),normalizedUrl=AdminUtils.normalizeSocialUrl(name.toLowerCase(),url);if(editingSocialId){const social=socials.find(s=>s.id===editingSocialId);social&&(social.name=name,social.url=normalizedUrl,await BackendData.saveData("socials",socials),AdminUtils.showToast("Réseau social modifié","success"))}else socials.push({id:Date.now(),name:name,url:normalizedUrl}),await BackendData.saveData("socials",socials),AdminUtils.showToast("Réseau social ajouté","success");return await loadSocials(),editingSocialId=null,resetForm("socialForm"),nameCustomInput.style.display="none",!0}async function editSocial(id){const social=(await BackendData.loadData("socials")).find(s=>s.id===id);social&&openSocialModal(social)}async function deleteSocial(id){if(!AdminUtils.confirmAction("Supprimer ce réseau social?"))return;const filtered=(await BackendData.loadData("socials")).filter(s=>s.id!==id);await BackendData.saveData("socials",filtered),await loadSocials(),AdminUtils.showToast("Réseau social supprimé","success")}window.editSocial=editSocial,window.deleteSocial=deleteSocial,window.Socials={initSocials:initSocials};