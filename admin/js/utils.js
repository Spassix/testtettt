async function hashPassword(password,salt){const data=(new TextEncoder).encode(password+salt),hash=await crypto.subtle.digest("SHA-256",data);return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,"0")).join("")}function generateSalt(){const array=new Uint8Array(16);return crypto.getRandomValues(array),Array.from(array,b=>b.toString(16).padStart(2,"0")).join("")}function escapeHtml(text){const div=document.createElement("div");return div.textContent=text,div.innerHTML}function generateInitials(name){if(!name)return"?";const parts=name.trim().split(" ");return parts.length>=2?(parts[0][0]+parts[1][0]).toUpperCase():name.substring(0,2).toUpperCase()}function formatDate(date){return date?new Date(date).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"}):""}function showToast(message,type="success"){const toast=document.createElement("div");toast.className=`toast toast-${type}`,toast.textContent=message,toast.style.cssText=`\n    position: fixed;\n    bottom: 2rem;\n    left: 50%;\n    transform: translateX(-50%);\n    background: ${"success"===type?"#22c55e":"error"===type?"#ef4444":"#f59e0b"};\n    color: white;\n    padding: 1rem 1.5rem;\n    border-radius: 12px;\n    z-index: 10000;\n    box-shadow: 0 10px 25px rgba(0,0,0,0.5);\n    animation: toastSlideUp 0.3s ease;\n  `,document.body.appendChild(toast),setTimeout(()=>{toast.style.opacity="0",toast.style.transform="translateX(-50%) translateY(-20px)",setTimeout(()=>toast.remove(),300)},3e3)}function confirmAction(message){return window.confirm(message)}function normalizeSocialUrl(platform,value){return value?(value=value.trim()).startsWith("http://")||value.startsWith("https://")?value:{instagram:value.startsWith("@")?`https://instagram.com/${value.substring(1)}`:`https://instagram.com/${value}`,tiktok:value.startsWith("@")?`https://tiktok.com/@${value.substring(1)}`:`https://tiktok.com/@${value}`,snapchat:value.startsWith("@")?`https://snapchat.com/add/${value.substring(1)}`:`https://snapchat.com/add/${value}`,telegram:value.startsWith("@")?`https://t.me/${value.substring(1)}`:`https://t.me/${value}`,whatsapp:value.startsWith("+")?`https://wa.me/${value.replace(/[^0-9]/g,"")}`:`https://wa.me/${value}`}[platform.toLowerCase()]||value:""}function validateUsername(username){return username?username.length<3?"Le nom d'utilisateur doit contenir au moins 3 caractères":username.length>20?"Le nom d'utilisateur ne peut pas dépasser 20 caractères":null:"Le nom d'utilisateur est requis"}function validatePassword(password){return password?password.length<6?"Le mot de passe doit contenir au moins 6 caractères":null:"Le mot de passe est requis"}function dataURLtoFile(dataurl,filename){const arr=dataurl.split(","),mime=arr[0].match(/:(.*?);/)[1],bstr=atob(arr[1]);let n=bstr.length;const u8arr=new Uint8Array(n);for(;n--;)u8arr[n]=bstr.charCodeAt(n);return new File([u8arr],filename,{type:mime})}function readFileAsDataURL(file){return new Promise((resolve,reject)=>{const reader=new FileReader;reader.onload=()=>resolve(reader.result),reader.onerror=reject,reader.readAsDataURL(file)})}function isValidUrl(string){try{const url=new URL(string);return"http:"===url.protocol||"https:"===url.protocol}catch(_){return!1}}function debounce(func,wait){let timeout;return function(...args){clearTimeout(timeout),timeout=setTimeout(()=>{clearTimeout(timeout),func(...args)},wait)}}window.AdminUtils={hashPassword:hashPassword,generateSalt:generateSalt,escapeHtml:escapeHtml,generateInitials:generateInitials,formatDate:formatDate,showToast:showToast,confirmAction:confirmAction,normalizeSocialUrl:normalizeSocialUrl,validateUsername:validateUsername,validatePassword:validatePassword,dataURLtoFile:dataURLtoFile,readFileAsDataURL:readFileAsDataURL,isValidUrl:isValidUrl,debounce:debounce,checkFileSize(file,maxSizeMB=2){const MAX_SIZE=1024*maxSizeMB*1024;return file.size>MAX_SIZE?{valid:!1,error:`Fichier trop volumineux (${(file.size/1048576).toFixed(2)}MB). Limite: ${maxSizeMB}MB.\n\nVeuillez utiliser une URL externe (YouTube, Vimeo, hébergement) pour les vidéos/grandes images.`}:{valid:!0}}};