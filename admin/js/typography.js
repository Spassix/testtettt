const FONTS_LIST=[{name:"Inter",category:"Sans-serif",weights:"400;600;700"},{name:"Montserrat",category:"Sans-serif",weights:"400;600;700"},{name:"Roboto",category:"Sans-serif",weights:"400;600;700"},{name:"Poppins",category:"Sans-serif",weights:"400;600;700"},{name:"Lato",category:"Sans-serif",weights:"400;600;700"},{name:"Open Sans",category:"Sans-serif",weights:"400;600;700"},{name:"Raleway",category:"Sans-serif",weights:"400;600;700"},{name:"Ubuntu",category:"Sans-serif",weights:"400;600;700"},{name:"Nunito",category:"Sans-serif",weights:"400;600;700"},{name:"Oswald",category:"Sans-serif",weights:"400;600;700"},{name:"Playfair Display",category:"Serif",weights:"400;600;700"},{name:"Merriweather",category:"Serif",weights:"400;600;700"},{name:"Lora",category:"Serif",weights:"400;600;700"},{name:"Bebas Neue",category:"Display",weights:"400"},{name:"Abril Fatface",category:"Display",weights:"400"},{name:"Bebas Neue",category:"Display",weights:"400"},{name:"Righteous",category:"Display",weights:"400"},{name:"Pacifico",category:"Handwriting",weights:"400"},{name:"Dancing Script",category:"Handwriting",weights:"400;600;700"},{name:"Satisfy",category:"Handwriting",weights:"400"},{name:"Comfortaa",category:"Sans-serif",weights:"400;600;700"},{name:"Source Sans Pro",category:"Sans-serif",weights:"400;600;700"},{name:"Fira Sans",category:"Sans-serif",weights:"400;600;700"},{name:"Work Sans",category:"Sans-serif",weights:"400;600;700"},{name:"Rubik",category:"Sans-serif",weights:"400;600;700"},{name:"Crimson Text",category:"Serif",weights:"400;600"},{name:"PT Serif",category:"Serif",weights:"400;600;700"},{name:"Libre Baskerville",category:"Serif",weights:"400"}];let selectedFont=null;async function initTypography(){await loadFonts(),await loadTypography(),setupTypographyUI()}async function loadFonts(){const fontNames=FONTS_LIST.map(f=>f.name),uniqueFonts=[...new Set(fontNames)],link=(uniqueFonts.map(f=>f.replace(" ","+")).join("&family="),document.createElement("link"));link.href=`https://fonts.googleapis.com/css2?${uniqueFonts.map(f=>`family=${f.replace(" ","+")}:wght@400;600;700`).join("&")}&display=swap`,link.rel="stylesheet",document.querySelector('link[href*="fonts.googleapis.com/css2"]')||document.head.appendChild(link),await document.fonts.ready,renderFontsGrid()}function renderFontsGrid(){const grid=document.getElementById("fontsGrid");grid&&(grid.innerHTML=FONTS_LIST.map(font=>{const fontId=font.name.replace(/\s+/g,"-").toLowerCase();return`\n      <div class="font-card" data-font="${font.name}" data-font-id="${fontId}">\n        <div class="font-preview" style="font-family: '${font.name}', sans-serif;">Aa</div>\n        <div class="font-name">${font.name}</div>\n        <div class="font-category">${font.category}</div>\n      </div>\n    `}).join(""),document.querySelectorAll(".font-card").forEach(card=>{card.addEventListener("click",()=>{document.querySelectorAll(".font-card").forEach(c=>c.classList.remove("selected")),card.classList.add("selected"),selectedFont=card.dataset.font;const customInput=document.getElementById("fontFamilyCustom");customInput&&(customInput.value=""),updateTypographyPreview()})}))}async function loadTypography(){const typography=await BackendData.loadData("typography"),customInput=document.getElementById("fontFamilyCustom"),fontSize=document.getElementById("fontSize");typography.customFamily?customInput&&(customInput.value=typography.customFamily):typography.family&&(selectedFont=typography.family,setTimeout(()=>{const card=document.querySelector(`[data-font="${typography.family}"]`);card&&card.classList.add("selected")},100)),fontSize&&(fontSize.value=typography.size||16),updateTypographyPreview()}function setupTypographyUI(){const saveBtn=document.getElementById("saveTypographyBtn"),fontFamilyCustom=document.getElementById("fontFamilyCustom"),fontSize=document.getElementById("fontSize");[fontFamilyCustom,fontSize].forEach(el=>{el&&(el.addEventListener("input",()=>{el===fontFamilyCustom&&el.value.trim()&&(document.querySelectorAll(".font-card").forEach(c=>c.classList.remove("selected")),selectedFont=null),updateTypographyPreview()}),el.addEventListener("change",updateTypographyPreview))}),saveBtn&&saveBtn.addEventListener("click",async()=>{const family=fontFamilyCustom.value.trim()||selectedFont||"Inter",size=parseInt(fontSize.value)||16,typography={family:selectedFont||"",customFamily:fontFamilyCustom.value.trim(),size:size};await BackendData.saveData("typography",typography),applyTypography(family,size),AdminUtils.showToast("Typographie sauvegardée","success")})}function updateTypographyPreview(){const preview=document.getElementById("typographyPreview");if(!preview)return;const customInput=document.getElementById("fontFamilyCustom"),family=customInput?.value.trim()||selectedFont||"Inter",size=parseInt(document.getElementById("fontSize")?.value)||16;preview.style.fontFamily=`'${family}', sans-serif`,preview.style.fontSize=`${size}px`}function applyTypography(family,size){const typography={family:selectedFont||"",customFamily:family!==selectedFont?family:"",size:size};localStorage.setItem("site_typography",JSON.stringify(typography)),window.dispatchEvent(new CustomEvent("adminDataUpdated",{detail:{key:"typography",data:typography}})),console.log("Typographie appliquée:",family,size)}window.Typography={initTypography:initTypography};